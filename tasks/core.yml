- name: Install system packages
  become: true
  community.general.xbps:
    name:
    - base-devel
    - cmake
    - pkg-config
    - acpi
    - polkit
    - acl
    - python3
    - python3-pipx
    state: present
  tags:
  - setup
  - core

- name: Add nonfree and multilib repository
  become: true
  community.general.xbps:
    name:
    - void-repo-nonfree
    - void-repo-multilib
    state: present
  tags:
  - setup
  - core

- name: CLI tools
  become: true
  community.general.xbps:
    name: 
    - bc
    - tree
    - tldr
    - ImageMagick
    - pulsemixer
    - fzf
    - fd
    - tmux
    - exa
    - nano
    - bat
    - htop
    - ripgrep
    - unzip
    - wget
    - curl
    - fwupd
    state: present
  tags:
  - setup
  - core

- name: Install calcure
  shell: pipx install --include-deps calcure

- name: Desktop environment
  become: true
  community.general.xbps:
    name: 
    - xorg
    - ibus
    - xautolock
    - i3lock-color
    - maim
    - unclutter
    - dunst
    - feh
    - xclip
    - xsel
    - Thunar
    - gsettings-desktop-schemas
    - direnv
    - cups
    - pipewire
    - wireplumber
    - alsa-utils
    - bluez
    - bluez-alsa
    - bluez-cups
    - lxappearance
    - lxsession
    - network-manager-applet
    - playerctl
    - picom
    - starship
    - rofi
    - xdg-user-dirs
    - xdg-desktop-portal-gtk
    - xf86-input-evdev
    - xf86-input-libinput
    - xf86-input-synaptics
    - xf86-input-vmmouse
    - xf86-input-wacom
    - xf86-video-amdgpu
    - xf86-video-intel
    - xf86-video-nouveau
    - xf86-video-openchrome
    - xf86-video-qxl
    - xf86-video-vmware
    - zathura
    - zathura-pdf-poppler
    - firefox
    - chromium
    - alacritty
    - xterm
    - qtile
    - awesome
    - polybar
    - gtk-theme-config
    - paper-gtk-theme
    - adwaita-icon-theme
    - arc-icon-theme
    - paper-icon-theme
    - papirus-icon-theme
    - tuigreet
    - elogind
    - vicious # awesome
    - dex     # awesome
    - rlwrap  # awesome 
    - imlib2  # awesome
    state: present

- name: Create X11 conf dir if not exists
  become: true
  ansible.builtin.file:
    path: /etc/X11/xorg.conf.d
    state: directory

- name: Set keyboard layout
  become: true
  copy:
    dest: /etc/X11/xorg.conf.d/00-keyboard.conf
    content: |
      Section "InputClass"
        Identifier "system-keyboard"
        MatchIsKeyboard "on"
        Option "XkbLayout" "ch"
        Option "XkbModel" "pc104"
        Option "XkbVariant" "de"
      EndSection

- name: Create user dirs
  shell: xdg-user-dirs-update --force

- name: Checkout Awesome Bling
  git:
    repo: 'https://github.com/BlingCorp/bling.git'
    dest: "{{ lookup('env', 'HOME') }}/.config/awesome/bling"

- name: Enable dbus service
  become: true
  community.general.runit:
    name: dbus
    enabled: true

# - name: Enable greetd service
#   become: true
#   community.general.runit:
#     name: greetd
#     enabled: true

# - name: Enable elogind service
#   become: true
#   community.general.runit:
#     name: elogind
#     enabled: true

- name: Enable bluetoothd service
  become: true
  community.general.runit:
    name: bluetoothd
    enabled: true

# - name: Enable alsa service
#   become: true
#   community.general.runit:
#     name: alsa
#     enabled: true

- name: Enable bluez-alsa service
  become: true
  community.general.runit:
    name: bluez-alsa
    enabled: true

- name: Enable cupsd service
  become: true
  community.general.runit:
    name: cupsd
    enabled: true

# - name: Desktop environment (Wayland)
#   become: true
#   community.general.xbps:
#     name: 
#     - wl-clipboard
#     - wayland-protocols
#     - arandr
#     - mako
#     - foot
#     - qtile-wayland
#     - sway
#     - swaybg
#     - swayidle
#     - swaylock
#     - Waybar
#     - python3-psutil
#     - python3-dbus
#     - xdg-desktop-portal-wlr
#     state: present

- name: Virtualization
  become: true
  community.general.xbps:
    name:
    - qemu
    state: present

- name: Multimedia
  become: true
  community.general.xbps:
    name: 
    - mpv
    - ffmpeg
    - libavcodec 
    state: present

- name: Fonts
  become: true
  community.general.xbps:
    name: 
    - nerd-fonts
    - font-awesome6
    state: present
 
- name: Checkout Qogir Theme
  git:
    repo: https://github.com/vinceliuice/Qogir-theme
    dest: /tmp/qogir

- name: Install Qogir Theme
  shell: bash install.sh
  args:
    chdir: /tmp/qogir

